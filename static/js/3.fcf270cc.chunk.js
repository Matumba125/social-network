(this["webpackJsonpsocial-network"]=this["webpackJsonpsocial-network"]||[]).push([[3],{449:function(e,s,t){e.exports={dialogs:"Dialogs_dialogs__2goUN",dialogs_items:"Dialogs_dialogs_items__1JDUH",messages:"Dialogs_messages__iGu3o",addMessage:"Dialogs_addMessage__165qa"}},450:function(e,s,t){e.exports={addMessage:"AddMessageForm_addMessage__1pBo-",messageInput:"AddMessageForm_messageInput__1eIFv",sendBtn:"AddMessageForm_sendBtn__3Z0hk"}},453:function(e,s,t){e.exports={message:"Message_message__3CLID",lastMessageWrapper:"Message_lastMessageWrapper__24vfZ",avatar:"Message_avatar__mw1E4",messageContent:"Message_messageContent__zSm26",lastMessage:"Message_lastMessage__2nboT",svgAppendix:"Message_svgAppendix__2H4ze",name:"Message_name__frqHt",text:"Message_text__228oE",time:"Message_time__23Oc7"}},454:function(e,s,t){e.exports={messagesWrapper:"Messages_messagesWrapper__3Ef1v"}},455:function(e,s,t){e.exports={chatWrapper:"Chat_chatWrapper__2X21x"}},457:function(e,s,t){"use strict";t.r(s);var a=t(0),n=t(449),r=t.n(n),i=t(60),c=t(125),o=t(451),l=t.n(o),u=t(450),d=t.n(u),j=t(56),f=t(458),g=t(3),v=["wsChannel"],m=function(e){var s=e.wsChannel,t=(Object(c.a)(e,v),Object(a.useState)("")),n=Object(i.a)(t,2),r=n[0],o=n[1],u=Object(a.useState)(!1),m=Object(i.a)(u,2),b=m[0],h=m[1];Object(a.useEffect)((function(){var e=function(){h(!0)};return s&&s.addEventListener("open",e),function(){null===s||void 0===s||s.removeEventListener("open",e)}}),[s]);var O=function(){r&&(s&&s.send(r),o(""))};return Object(g.jsxs)("div",{className:d.a.addMessage,children:[Object(g.jsx)(l.a,{className:d.a.messageInput,autoSize:{minRows:1},value:r,onChange:function(e){o(e.target.value)},onKeyPress:function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),O())}}),Object(g.jsx)(j.a,{icon:Object(g.jsx)(f.a,{style:{color:"rgba(0, 0, 0, 0.85)"}}),type:"text",className:d.a.sendBtn,onClick:O,disabled:!b})]})},b=t(107),h=t(453),O=t.n(h),_=t(242),p=t(432),x=function(e){var s=e.last||e.unique?O.a.lastMessageWrapper:O.a.message,t=e.last||e.unique?O.a.lastMessage:O.a.messageContent;return Object(g.jsxs)("div",{className:s,children:[(e.last||e.unique)&&Object(g.jsxs)("div",{children:[Object(g.jsx)(_.a,{src:e.photo&&e.photo,icon:!e.photo&&Object(g.jsx)(p.a,{}),className:O.a.avatar,size:40}),Object(g.jsx)("div",{className:O.a.svgAppendix,children:Object(g.jsxs)("svg",{width:"9",height:"20",xmlns:"http://www.w3.org/2000/svg",children:[Object(g.jsx)("defs",{children:Object(g.jsxs)("filter",{x:"-50%",y:"-14.7%",width:"200%",height:"141.2%",filterUnits:"objectBoundingBox",id:"a",children:[Object(g.jsx)("feOffset",{dy:"1",in:"SourceAlpha",result:"shadowOffsetOuter1"}),Object(g.jsx)("feGaussianBlur",{stdDeviation:"1",in:"shadowOffsetOuter1",result:"shadowBlurOuter1"}),Object(g.jsx)("feColorMatrix",{values:"0 0 0 0 0.0621962482 0 0 0 0 0.138574144 0 0 0 0 0.185037364 0 0 0 0.15 0",in:"shadowBlurOuter1"})]})}),Object(g.jsxs)("g",{fill:"none",fillRule:"evenodd",children:[Object(g.jsx)("path",{d:"M3 17h6V0c-.193 2.84-.876 5.767-2.05 8.782-.904 2.325-2.446 4.485-4.625 6.48A1 1 0 003 17z",fill:"rgb(24, 37, 51)",filter:"url(#a)"}),Object(g.jsx)("path",{d:"M3 17h6V0c-.193 2.84-.876 5.767-2.05 8.782-.904 2.325-2.446 4.485-4.625 6.48A1 1 0 003 17z",fill:"rgb(24, 37, 51)",className:"corner"})]})]})})]}),Object(g.jsxs)("div",{className:t,children:[(e.first||e.unique)&&Object(g.jsx)("div",{className:O.a.name,children:e.userName}),Object(g.jsx)("div",{className:O.a.text,children:e.message})]})]})},M=t(454),w=t.n(M),E=["wsChannel"],N=function(e){var s=e.wsChannel,t=(Object(c.a)(e,E),Object(a.useState)([])),n=Object(i.a)(t,2),r=n[0],o=n[1],l=Object(a.useState)([]),u=Object(i.a)(l,2),d=u[0],j=u[1];return Object(a.useEffect)((function(){var e=r.slice();if(r)for(var s=0;s<e.length;s++){var t,a,n;if(e[s].userId===(null===(t=e[s+1])||void 0===t?void 0:t.userId)&&e[s].userId!==(null===(a=e[s-1])||void 0===a?void 0:a.userId)){e[s].first=!0;for(var i=s;e[i].userId===(null===(c=e[i+1])||void 0===c?void 0:c.userId)&&e[i+1].userId;){var c;i++}e[i-1].last=!1,e[i].last=!0,s=i}e[s].userId===(null===(n=e[s+1])||void 0===n?void 0:n.userId)||e[s].last||(e[s].unique=!0)}j(e)}),[r]),Object(a.useEffect)((function(){var e=function(e){var s=JSON.parse(e.data);o((function(e){return[].concat(Object(b.a)(e),Object(b.a)(s))}));var t=document.getElementById("data");setTimeout((function(){t&&(t.scrollTop=t.scrollHeight)}),5)};return null===s||void 0===s||s.addEventListener("message",e),function(){null===s||void 0===s||s.removeEventListener("message",e)}}),[s]),Object(g.jsx)("div",{id:"data",className:w.a.messagesWrapper,children:d.map((function(e,s){return Object(g.jsx)(x,{userName:e.userName,message:e.message,userId:e.userId,photo:e.photo,first:e.first,last:e.last,unique:e.unique},s)}))})},I=t(455),C=t.n(I),B=function(e){var s=Object(a.useState)(null),t=Object(i.a)(s,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){var e,s=function(){setTimeout(t,3e3)};function t(){var t,a;null===(t=e)||void 0===t||t.removeEventListener("close",s),null===(a=e)||void 0===a||a.close(),e=new WebSocket("wss://social-network.samuraijs.com/handlers/ChatHandler.ashx"),null===n||void 0===n||n.addEventListener("close",s),r(e)}return t(),function(){e.removeEventListener("close",s),e.close()}}),[]),Object(a.useEffect)((function(){null===n||void 0===n||n.addEventListener("close",(function(){}))}),[n]),Object(g.jsxs)("div",{className:C.a.chatWrapper,children:[Object(g.jsx)(N,{wsChannel:n}),Object(g.jsx)(m,{wsChannel:n})]})};s.default=function(e){return Object(g.jsx)("div",{className:r.a.dialogs,children:Object(g.jsx)(B,{})})}}}]);
//# sourceMappingURL=3.fcf270cc.chunk.js.map